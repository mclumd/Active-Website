<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.1 release (March 30, 1999)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Input Processing</TITLE>
<META NAME="description" CONTENT="Input Processing">
<META NAME="keywords" CONTENT="clim">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v99.1 release">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="clim.css">

<LINK REL="next" HREF="node89.html">
<LINK REL="previous" HREF="node83.html">
<LINK REL="up" HREF="node43.html">
<LINK REL="next" HREF="node88.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html1927"
 HREF="node88.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html1923"
 HREF="node43.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html1917"
 HREF="node86.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html1925"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1928"
 HREF="node88.html">Input Contracts</A>
<B> Up:</B> <A NAME="tex2html1924"
 HREF="node43.html">Windowing Substrate</A>
<B> Previous:</B> <A NAME="tex2html1918"
 HREF="node86.html">Providing a Display Medium</A>
 &nbsp <B>  <A NAME="tex2html1926"
 HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION04600000000000000000">
Input Processing</A>
</H1>

<P>
Silica provides an input architecture and standard functionality for notifying
clients of input that is distributed to their sheets.  Input includes the
pointer entering and exiting sheets, pointer motion as allowed by performance,
and mouse button and keyboard events.

<P>
Programmers who would like to design specialized input machinery need to
understand the details of Silica's input distribution architecture.  This
section covers that topic.  Most users of higher levels of CLIM need not
concern themselves with the details presented here.

<P>
Silica separates device input processing into two phases:  distribution
(determining which sheet should receive the input), and delivery (translating
the raw input into a representation suitable to the client of the recipient
sheet).  The design goals for the input architecture include allowing flexible
selection of both distribution and delivery policies as well as providing
standard policies that are portable across a wide variety of host window servers
and sufficient for most applications.  This input architecture supports both
event-oriented and stream-oriented input interfaces; and both single and
multiple process environments.

<P>
The flow of input processing proceeds as follows.  Device events come in from a
port in a window server specific way.  Each device event is directed to an event
distributor that is responsible for determining the recipient of the input, and
possibly also for generating crossing events on mouse motion.  A standard
distributor is provided and chosen by default for most ports.

<P>
After a recipient is found for a device event, the device event is passed to the
input contract of the sheet.  The input contract translates and delivers the
event to the sheet's client.  This means that an input contract must define a
method for converting and delivery the device event of each port type that it
supports.  This approach allows delayed representation of input based on the
final recipient of the input.  The standard input contracts are described below.

<P>
Each port has a event processor that processes all of the
implementation-specific device events.  This port event processor may run in a
separate per-port process or can be invoked directly by higher levels in a
single-process environment.  For example, in a multiprocess environment a port
event handler would run code similar to the following:

<P>
 
<PRE>

   (loop (process-next-event display))
</PRE>

<P>
process-next-event port <TT> &amp;key </TT>timeout

<P>
This function provides a standard interface for one pass through a port's event
processing loop.  It returns <I> true</I> if an event was processed, otherwise it
returns <I> false</I> (meaning that the function timed out).  A port
implementation must provide a method for this function that reads the next
window server specific device event (blocking if necessary) and then invokes the
port's event distributor via a call to distribute-device-event.  This
method is required to pass along some necessary keyword arguments along with any
port specific keyword args that will eventually be parsed by port-specific
methods defined on the input contract of the recipient sheet.

<P>
distribute-device-event distributor port source <TT> &amp;key  &amp;allow-other-keys </TT>

<P>
A distributor implementation must provide a method for this function.
<I> Source</I> indicates the sheet that corresponds to the host window that the
event was delivered to by the window server.  This method is responsible for
invoking dispatch-device-event or dispatch-crossing-event on input
contract of sheet's.

<P>
standard-event-distributor 

<P>
This class implements the standard distribution policy supported by Silica.
Pointer button and motion events are distributed to deepest sheet in the
hierarchy that contains the pointer at the time that the event is generated.
Keyboard events can be distributed either to a particular sheet or to the same
sheet that would receive pointer events.

<P>
dispatch-device-event port input-contract <TT> &amp;key </TT>sheet <TT> &amp;allow-other-keys </TT>
dispatch-crossing-event port input-contract <TT> &amp;key </TT>sheet <TT> &amp;allow-other-keys </TT>

<P>
These functions are invoked by an event distributor.  Typically the
input-contract is the same object as the sheet and some generic as well as some
port-specific keywords arguments indicating the device event are passed in.
Input contract implementations provide methods specialized on each of the ports
that the input contract is supported on.  These methods are responsible for
parsing the keyword arguments and delivering the event to the client of the
sheet.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html1929"
 HREF="node88.html">Input Contracts</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html1927"
 HREF="node88.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html1923"
 HREF="node43.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html1917"
 HREF="node86.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html1925"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1928"
 HREF="node88.html">Input Contracts</A>
<B> Up:</B> <A NAME="tex2html1924"
 HREF="node43.html">Windowing Substrate</A>
<B> Previous:</B> <A NAME="tex2html1918"
 HREF="node86.html">Providing a Display Medium</A>
 &nbsp <B>  <A NAME="tex2html1926"
 HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>&</I>
<BR><I>2001-06-12</I>
</ADDRESS>
</BODY>
</HTML>
