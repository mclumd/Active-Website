<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.1 release (March 30, 1999)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Dialog Facilities</TITLE>
<META NAME="description" CONTENT="Dialog Facilities">
<META NAME="keywords" CONTENT="clim">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v99.1 release">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="clim.css">

<LINK REL="previous" HREF="node239.html">
<LINK REL="up" HREF="node195.html">
<LINK REL="next" HREF="node241.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html4010"
 HREF="node241.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html4006"
 HREF="node195.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html4002"
 HREF="node239.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html4008"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html4011"
 HREF="node241.html">Building Applications</A>
<B> Up:</B> <A NAME="tex2html4007"
 HREF="node195.html">Extended Stream Input Facilities</A>
<B> Previous:</B> <A NAME="tex2html4003"
 HREF="node239.html">Menu Facilities</A>
 &nbsp <B>  <A NAME="tex2html4009"
 HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION07500000000000000000"></A>
<A NAME="dialogs"></A>
<BR>
Dialog Facilities
</H1>

<P>
SWM There is a general issue about how these dialogs fit in with the
dialogs that might be provided by the underlying toolkit.

<P>
accepting-values (<TT> &amp;optional </TT>stream
                               <TT> &amp;key </TT>own-window exit-boxes initially-select-query-identifier
                                    resynchronize-every-pass
                                    label x-position y-position frame-class)
                              <TT> &amp;body </TT>body

<P>
Builds a dialog for user interaction based on calls to accept within
<I> body</I>. The user can select the values and change them, or use defaults if
they are supplied.  The dialog will also contain some sort of ``abort'' and
``done'' choices.  If ``end'' is selected, then accepting-values returns
whatever values the body returns. If ``abort'' is selected,
accepting-values will invoke the abort restart.

<P>
 
<I> stream</I> is an interactive stream that accepting-values will use to
build up the dialog.  The <I> stream</I> argument is not evaluated, and must be a
symbol that is bound to a stream.  If <I> stream</I> is t (the default),
*query-io* is used.

<P>
 
<I> body</I> is the body of the dialog, which contains calls to accept that
will be intercepted by accepting-values and used to build up the dialog.
<I> body</I> may have zero or more declarations as its first forms.

<P>
An accepting-values dialog is implemented as a looping structure.  First,
<I> body</I> is evaluated in order to collect the output.  While the body is being
evaluated, all calls to accept call the accept-present-default
presentation methods instead of calling the accept presentation methods.
The output is then displayed (preferably using incremental redisplay in order to
avoid unnecessary redisplay of unchanged output).  Then accepting-values
awaits a user gesture, such as clicking on one of the fields of the dialog.
When the user clicks on a field, accepting-values reads a new value for
that field using accept and replaces the old value with the new value.
Then the loop is started again, until the user either exits or aborts from the
dialog.

<P>
Because of this looping structure, accepting-values needs to be able to
uniquely identify each call to accept in the body of the dialog.  The
<I> query identifier</I><A NAME="31335"></A> is used to identify the calls to accept.  The
query identifier for a call to accept is computed on each loop through the
dialog, and should therefore be free of side-effects.  Query identifiers are
compared using equal.  Inside of accepting-values, programmers should
supply the :query-identifier argument to each call to accept.  If
:query-identifier is not explicitly supplied, the prompt for that call to
accept is used as the query identifier.  Thus, if :query-identifier is
not supplied, programmers must ensure that all of the prompts are different.  If
there is more than one call to accept with the same query identifier, the
behavior of accepting-values is unspecified.  

<P>
While inside accepting-values, calls to accept return a third value, a
boolean (``changed-p'') that indicates whether the object is the result of new
input by the user, or is just the previously supplied default.  The third value
will be <I> true</I> in the former case, <I> false</I> in the latter.

<P>
 
<B> Implementation note:</B> each invocation of accepting-values will
probably need to maintain a table that maps from a query identifier to the
output record for the field that used the query identifier, and the output
record for each field in the dialog will probably need a mapping back to the
query identifier.  A mediating object (a ``query object'') is also useful, for
instance, as a place to store the ``changed-p'' flag.

<P>
When <I> own-window</I> is non-nil, the dialog will appear in its own
``popped-up'' window.  In this case the initial value of <I> stream</I> is a window
with which the dialog is associated.  This is similar to the
<I> associated-window</I> argument to menu-choose.  Within the <I> body</I>,
the value of <I> stream</I> will be the ``popped-up'' window.  <I> own-window</I> be
either t or a list of alternating keyword options and values.  The accepted
options are :right-margin and :bottom-margin; their values control the
amount of extra space to the right of and below the dialog (useful if the user's
responses to the dialog take up more space than the initially displayed
defaults).  The allowed values for :right-margin are the same as for the
:x-spacing option to formatting-table; the allowed values for
:bottom-margin are the same as for the :y-spacing option.

<P>
 
<I> exit-boxes</I> specifies what the exit boxes should look like. The default
behavior is though the following were supplied:

<P>
 
<PRE>

'((:exit "&lt;End&gt; uses these values")
  (:abort "&lt;Abort&gt; aborts"))
</PRE>

<P>
 
<I> initially-select-query-identifier</I> specifies that a particular field in the
dialog should be pre-selected when the user interaction begins. The field to be
selected is tagged by the :query-identifier option to accept.  When
the initial display is output, the input editor cursor appears after the prompt
of the tagged field, just as if the user had selected that field by clicking on
it. The default value, if any, for the selected field is not displayed.

<P>
 
<I> resynchronize-every-pass</I> is a boolean option specifying whether earlier
queries depend on later values; the default is <I> false</I>.  When it is
<I> true</I>, the contents of the dialog are redisplayed an additional time after
each user interaction.  This has the effect of ensuring that, when the value of
some field of a dialog depends on the value of another field, all of the
displayed fields will be up to date.

<P>
 
<I> label</I> is as for menu-choose.  <I> x-position</I> and <I> y-position</I>
are as for menu-choose-from-drawer.

<P>
accept-values

<P>
accepting-values must be implemented as a CLIM application frame that uses
accept-values as the name of the frame class.

<P>
display-exit-boxes frame stream exit-boxes

<P>
Interprets the <I> exit-boxes</I> specification (which is as for
accepting-values) and displays the exit boxes for the dialog frame
<I> frame</I> on the stream <I> stream</I>.  The default method (on
accept-values) simply writes a line of text associated the Exit and Abort
strings with presentations that either exit or abort from the dialog.

<P>
The <I> frame</I> and <I> stream</I> arguments may be specialized to provide
a different look-and-feel for different host window systems.

<P>
accept-values-resynchronize stream

<P>
Causes accepting-values to resynchronizes the dialog once on the accepting
values stream <I> stream</I> before it restarts the dialog loop.

<P>
accept-values-command-button (<TT> &amp;optional </TT>stream
                                           <TT> &amp;key </TT>documentation query-identifier
                                                cache-value cache-test resynchronize) 
                                          prompt
                                          <TT> &amp;body </TT>body

<P>
Displays the prompt <I> prompt</I> on the stream <I> stream</I> and creates an area
(the ``button'').  When a pointer button is clicked in this area at runtime,
<I> body</I> will be evaluated.  <I> prompt</I> may be either a string (which will
be displayed via write-string), or a form that will be evaluated to draw
the button.  <I> body</I> may have zero or more declarations as its first forms.

<P>
The <I> stream</I> argument is not evaluated, and must be a symbol that is bound
to a stream.  If <I> stream</I> is t (the default), *query-io* is used.

<P>
 
<I> documentation</I> is an object that will be used to produce pointer
documentation for the button.  It defaults to <I> prompt</I>.  If it is a string,
the string itself will be used as the pointer documentation.  Otherwise it must
be a function of one argument, the stream to which the documentation should be
written.

<P>
When <I> resynchronize</I> is <I> true</I>, the dialog will be redisplayed an
additional time whenever the command button is clicked on.  See the
<I> resynchronize-every-pass</I> argument to accepting-values.

<P>
 
<I> cache-value</I> and <I> cache-test</I> are as for updating-output.  That
is, <I> cache-value</I> should evaluate to the same value if and only if the
output produced by <I> prompt</I> does not ever change.  <I> cache-test</I> is a
function of two arguments that is used to compare cache values.
<I> cache-value</I> defaults to t and <I> cache-test</I> defaults to eql.

<P>
This function may only be used inside the dynamic context of an
accepting-values.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html4010"
 HREF="node241.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html4006"
 HREF="node195.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html4002"
 HREF="node239.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html4008"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html4011"
 HREF="node241.html">Building Applications</A>
<B> Up:</B> <A NAME="tex2html4007"
 HREF="node195.html">Extended Stream Input Facilities</A>
<B> Previous:</B> <A NAME="tex2html4003"
 HREF="node239.html">Menu Facilities</A>
 &nbsp <B>  <A NAME="tex2html4009"
 HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>&</I>
<BR><I>2001-06-12</I>
</ADDRESS>
</BODY>
</HTML>
