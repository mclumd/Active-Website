<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.1 release (March 30, 1999)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The Generic Command Loop</TITLE>
<META NAME="description" CONTENT="The Generic Command Loop">
<META NAME="keywords" CONTENT="clim">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v99.1 release">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="clim.css">

<LINK REL="previous" HREF="node254.html">
<LINK REL="up" HREF="node253.html">
<LINK REL="next" HREF="node256.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html4251"
 HREF="node256.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html4247"
 HREF="node253.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html4243"
 HREF="node254.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html4249"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html4252"
 HREF="node256.html">Window Viewport Management</A>
<B> Up:</B> <A NAME="tex2html4248"
 HREF="node253.html">The Application Frame Protocol</A>
<B> Previous:</B> <A NAME="tex2html4244"
 HREF="node254.html">Interface with Presentation Types</A>
 &nbsp <B>  <A NAME="tex2html4250"
 HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION08232000000000000000">
The Generic Command Loop</A>
</H2>

<P>
The default application command loop provided by CLIM performs the following
steps:

<P>

<OL>
<LI>Prompts the user for input.

<P>
 </LI>
<LI>Reads a command.  Each application frame has a command table that contains
those commands that the author of the application wishes to allow the user to
invoke at a given time.  Commands may be read in any number of ways.  The
generic command loop enforces no particular interface style.

<P>
 </LI>
<LI>Executes the command.  The definition of each command may refer to (and
update) the state variables of the frame, to which *application-frame* will
be bound.

<P>
 </LI>
<LI>Runs the display function for each pane in the frame.  The display function
may refer to the frame's state variables.  Display functions are usually written
by the application writer, although certain display functions are supplied by
CLIM itself.  Note that an application frame is free to have no panes.</LI>
</OL>

<P>
SWM RWK has a reasonable proposal for breaking down command loops into
their component pieces.  It should be integrated here.

<P>
All classes that inherit from application-frame must inherit or implement
methods for all of these functions.

<P>
run-frame-top-level frame

<P>
Runs the top-level function for the <I> frame</I> <I> frame</I>.  The default
method on application-frame simply invokes the top-level function for the
frame (which defaults to default-frame-top-level).

<P>
run-frame-top-level (frame application-frame)

<P>
The :around method of run-frame-top-level on the
application-frame class is responsible for binding *application-frame*
to <I> frame</I>.

<P>
default-frame-top-level frame <TT> &amp;key </TT>command-parser command-unparser 
                                                  partial-command-parser
                                                  prompt

<P>
The default top-level function for application frames.  This function implements
a ``read-eval-print'' loop that displays a prompt, calls
read-frame-command, then calls execute-frame-command, and finally
redisplays all of the panes that need to be redisplayed.

<P>
default-frame-top-level will also establish a simple restart for
abort, and bind the standard stream variables as follows.
*standard-input* will be bound to the value returned by
frame-standard-input.  *standard-output* will be bound to the value
returned by frame-standard-output.  *query-io* will be bound to the
value returned by frame-query-io.  *error-output* will be bound to the
value returned by frame-error-output.  It is unspecified what
*debug-io* will be bound to.

<P>
 
<I> prompt</I> is either a string to use as the prompt (defaulting to
"Command: ", or a function of two arguments (a stream and the frame).

<P>
 
<I> command-parser</I>, <I> command-unparser</I>, and <I> partial-command-parser</I>
are the same as for read-command.  <I> command-parser</I> defaults to
command-line-command-parser if there is an interactor, otherwise it
defaults to menu-only-command-parser.  <I> command-unparser</I> defaults to
command-line-command-unparser.  <I> partial-command-parser</I> defaults to
command-line-read-remaining-arguments-for-partial-command if there is an
interactor, otherwise it defaults to
menu-only-read-remaining-arguments-for-partial-command.

<P>
read-frame-command frame stream

<P>
Reads a command from the stream <I> stream</I> on behalf of the <I> frame</I>
<I> frame</I>.  The returned value is a command object.

<P>
The default method (on standard-application-frame) for
read-frame-command simply calls read-command, supplying <I> frame</I>'s
current command table as the command table.

<P>
execute-frame-command frame command

<P>
Executes the command <I> command</I> on behalf of the <I> frame</I> <I> frame</I>.
<I> command</I> is a command object, that is, a cons of a command name and a list
of the command's arguments.

<P>
The default method (on standard-application-frame) for
execute-frame-command simply applies the command-name of <I> command</I>
to command-arguments of <I> command</I>.

<P>
command-enabled command-name frame

<P>
Returns <I> true</I> if the command named by <I> command-name</I> is presently
enabled in the <I> frame</I> <I> frame</I>, otherwise returns <I> false</I>.  If
<I> command-name</I> is not accessible to the command table being used by
<I> frame</I>, command-enabled returns <I> false</I>.

<P>
Whether or not a particular command is currently enabled is stored independently
for each instance of an application frame; this status can vary between frames
that share a single command table.

<P>
 
(setf command-enabled) enabled command-name frame

<P>
If <I> enabled</I> is <I> false</I>, this disables the use of the command named by
<I> command-name</I> while in the <I> frame</I> <I> frame</I>.  Otherwise if
<I> enabled</I> is <I> true</I>, the use of the command is enabled.  After the
command has been enabled (or disabled), note-command-enabled is invoked on
the frame manager in order to update the appearance of the interface.

<P>
If <I> command-name</I> is not accessible to the command table being used by
<I> frame</I>, using setf on command-enabled does nothing.

<P>
display-command-menu frame stream
                                    <TT> &amp;key </TT>command-table initial-spacing
                                         max-width max-height n-rows n-columns
                                         (cell-align-x :left) (cell-align-y :top)

<P>
Displays the menu associated with the specified command table on <I> stream</I> by
calling display-command-table-menu.  If <I> command-table</I> is not
supplied, it defaults to (frame-command-table <I> stream</I>).  This function
is generally used as the display function for panes that contain command menus.

<P>
 
<I> initial-spacing</I>, <I> max-width</I>, <I> max-height</I>, <I> n-rows</I>, <I> n-columns</I>,
<I> cell-align-x</I>, and <I> cell-align-y</I> are as for formatting-item-list.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html4251"
 HREF="node256.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html4247"
 HREF="node253.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html4243"
 HREF="node254.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html4249"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html4252"
 HREF="node256.html">Window Viewport Management</A>
<B> Up:</B> <A NAME="tex2html4248"
 HREF="node253.html">The Application Frame Protocol</A>
<B> Previous:</B> <A NAME="tex2html4244"
 HREF="node254.html">Interface with Presentation Types</A>
 &nbsp <B>  <A NAME="tex2html4250"
 HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>&</I>
<BR><I>2001-06-12</I>
</ADDRESS>
</BODY>
</HTML>
