<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.1 release (March 30, 1999)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Command Menus</TITLE>
<META NAME="description" CONTENT="Command Menus">
<META NAME="keywords" CONTENT="clim">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v99.1 release">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="clim.css">

<LINK REL="next" HREF="node246.html">
<LINK REL="previous" HREF="node244.html">
<LINK REL="up" HREF="node242.html">
<LINK REL="next" HREF="node246.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html4123"
 HREF="node246.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html4119"
 HREF="node242.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html4113"
 HREF="node244.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html4121"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html4124"
 HREF="node246.html">Keystroke Accelerators</A>
<B> Up:</B> <A NAME="tex2html4120"
 HREF="node242.html">Command Processing</A>
<B> Previous:</B> <A NAME="tex2html4114"
 HREF="node244.html">Command Tables</A>
 &nbsp <B>  <A NAME="tex2html4122"
 HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION08130000000000000000">
Command Menus</A>
</H1>

<P>
Each command table may have a menu consisting of an ordered sequence of menu
items.  The menu specifies a mapping from a menu name (the name displayed in the
menu) to a menu item.  The menu of an application frame's top-level command
table may be presented in a window system specific way, for example, as a menu
bar.

<P>
Menu items are stored as a list of the form
(<I> type</I> <I> value</I> . <I> options</I>), where <I> type</I> and <I> value</I>
are as in add-menu-item-to-command-table, and <I> options</I> is a list of
keyword-value pairs.  The allowable keywords are :documentation, which is
used to supply optional pointer documention for the menu item, and
:text-style, which is used to indicate what text style should be used for
this menu item when it is displayed in a command menu.

<P>
add-menu-item-to-command-table, remove-menu-item-from-command-table,
and find-menu-item ignore the character case and style of the menu item's
name when searching through the command table's menu.

<P>
add-menu-item-to-command-table command-table string type value 
                                         <TT> &amp;key </TT>documentation (after ':end) keystroke
                                              text-style (errorp t)

<P>
Adds a menu item to <I> command-table</I>'s menu.  <I> string</I> is the name of the
menu item; its character case and style are ignored.  <I> type</I> is either
:command, :function, :menu, or :divider.
<I> command-table</I> is a <I> command table designator</I>.

<P>
SWM How do we make iconic command menus?  Probably another keyword...

<P>
When <I> type</I> is :command, <I> value</I> must be a command (a cons of a
command name followed by a list of the command's arguments), or a command name.
(When <I> value</I> is a command name, it behaves as though a command with no
arguments was supplied.)  In the case where all of the command's required
arguments are supplied, clicking a a menu item invokes the command immediately.
Otherwise, the user will be prompted for the remaining required arguments.

<P>
When <I> type</I> is :function, <I> value</I> must be function having
indefinite extent that, when called, returns a command.  The function is called
with two arguments, the gesture the user used to select the item (either a
keyboard or button press event) and a ``numeric argument''.

<P>
When <I> type</I> is :menu, this item indicates that a sub-menu will be
invoked, and so <I> value</I> must be another command table or the name of
another command table.

<P>
When <I> type</I> is :divider, some sort of a dividing line is displayed in
the menu at that point.  If <I> string</I> is supplied, it will be drawn as the
divider instead of a line.  If the look and feel provided by the underlying
window system has no corresponding concept, :divider items may be ignored.
<I> value</I> is ignored.

<P>
 
<I> documentation</I> is a documentation string, which can be used as mouse
documentation for the menu item.

<P>
 
<I> text-style</I> is either a text style spec or nil.  It is used to
indicate that the menu item should be drawn with the supplied text style in
command menus.

<P>
 
<I> after</I> must be either :start (meaning to add the new item to the
beginning of the menu), :end or nil (meaning to add the new item to
the end of the menu), or a string naming an existing entry (meaning to add the
new item after that entry).  If <I> after</I> is :sort, then the item is
inserted in such as way as to maintain the menu in alphabetical order.

<P>
If <I> keystroke</I> is supplied, the menu item will be added to the command
table's keystroke accelerator table.  The value of <I> keystroke</I> must be a
keyboard gesture name.  This is exactly equivalent to calling
add-keystroke-to-command-table with the arguments <I> command-table</I>,
<I> keystroke</I>, <I> type</I> and <I> value</I>.  When <I> keystroke</I> is supplied
and <I> type</I> is :command or :function, typing a key on the keyboard
that matches to the keystroke accelerator gesture will invoke the command
specified by <I> value</I>.  When <I> type</I> is :menu, the command will
continue to be read from the sub-menu indicated by <I> value</I> in a window
system specific manner.

<P>
If the item named by <I> string</I> is already present in the command table's menu
and <I> errorp</I> is <I> true</I>, then the command-already-present error
will be signalled.  When the item is already present in the command table's menu
and <I> errorp</I> is <I> false</I>, the old item will first be removed from the
menu.  Note that the character case and style of <I> string</I> are ignored when
searching the command table's menu.

<P>
remove-menu-item-from-command-table command-table string <TT> &amp;key </TT>(errorp t)

<P>
Removes the item named by <I> string</I> from <I> command-table</I>'s menu.
<I> command-table</I> is a <I> command table designator</I>.

<P>
If the menu item is not present in the command table's menu and <I> errorp</I> is
<I> true</I>, then the command-not-present error will be signalled.  Note
that the character case and style of <I> string</I> are ignored when searching the
command table's menu.

<P>
map-over-command-table-menu-items function command-table

<P>
Applies <I> function</I> to all of the menu items in <I> command-table</I>'s menu.
<I> function</I> must be a function of three arguments, the menu name, the
keystroke accelerator gesture (which will be nil if there is none), and the
menu item; it has dynamic extent.  The menu items are mapped in the order
specified by add-menu-item-to-command-table.  <I> command-table</I> is a
<I> command table designator</I>.

<P>
map-over-command-table-menu-items does not descend into sub-menus.  If the
programmer requires this behavior, he should examine the type of the menu item
to see if it is :menu.

<P>
find-menu-item menu-name command-table <TT> &amp;key </TT>(errorp t)

<P>
Given a menu name and a command table, returns two values, the menu item and the
command table in which it was found.  (Since menus are not inherited, the second
returned value will always be <I> command-table</I>.)  <I> command-table</I> is a
<I> command table designator</I>.
This function returns objects that reveal CLIM's internal state;
do not modify those objects. 
<P>
If the menu item is not present in <I> command-table</I> and <I> errorp</I> is
<I> true</I>, then the command-not-accessible error will be signalled.  Note
that the character case and style of <I> string</I> are ignored when searching the
command table's menu.

<P>
command-menu-item-type menu-item

<P>
Returns the type of the menu item <I> menu-item</I>, for example, :menu or
:command.  If <I> menu-item</I> is not a menu item, the result is
unspecified.

<P>
command-menu-item-value menu-item

<P>
Returns the value of the menu item <I> menu-item</I>.  For example, if the type of
<I> menu-item</I> is :command, this will return a command or a command name.
If <I> menu-item</I> is not a menu item, the result is unspecified.

<P>
command-menu-item-options menu-item

<P>
Returns a list of the options for the menu item <I> menu-item</I>.  If
<I> menu-item</I> is not a menu item, the result is unspecified.

<P>
display-command-table-menu command-table stream
                                          <TT> &amp;key </TT>max-width max-height n-rows n-columns
                                               x-spacing y-spacing initial-spacing
                                               (cell-align-x :left) (cell-align-y :top)
                                               (move-cursor t)

<P>
Displays <I> command-table</I>'s menu on <I> stream</I>.  Implementations may choose
to use formatting-item-list or may display the command table's menu in a
platform dependent manner, such as using the menu bar on a Macintosh.
<I> command-table</I> is a <I> command table designator</I>.

<P>
 
<I> max-width</I>, <I> max-height</I>, <I> n-rows</I>, <I> n-columns</I>,
<I> x-spacing</I>, <I> y-spacing</I>, <I> initial-spacing</I>, <I> cell-align-x</I>,
<I> cell-align-y</I>, and <I> move-cursor</I> are as for formatting-item-list.

<P>
menu-choose-command-from-command-table command-table 
                                                 <TT> &amp;key </TT>associated-window default-style label
                                                      cache unique-id id-test
                                                      cache-value cache-test

<P>
Invokes a window system specific routine that displays a menu of commands from
<I> command-table</I>'s menu, and allows the user to choose one of the commands.
<I> command-table</I> is a <I> command table designator</I>.  The returned value is
a command object.  This may invoke itself recursively when there are sub-menus.

<P>
 
<I> associated-window</I>, <I> default-style</I>, <I> label</I>, <I> cache</I>,
<I> unique-id</I>, <I> id-test</I>, <I> cache-value</I>, and <I> cache-test</I> are as
for menu-choose.

<P>
SWM Should this be generic on application frames?

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html4123"
 HREF="node246.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html4119"
 HREF="node242.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html4113"
 HREF="node244.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html4121"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html4124"
 HREF="node246.html">Keystroke Accelerators</A>
<B> Up:</B> <A NAME="tex2html4120"
 HREF="node242.html">Command Processing</A>
<B> Previous:</B> <A NAME="tex2html4114"
 HREF="node244.html">Command Tables</A>
 &nbsp <B>  <A NAME="tex2html4122"
 HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>&</I>
<BR><I>2001-06-12</I>
</ADDRESS>
</BODY>
</HTML>
