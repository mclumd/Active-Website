<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.1 release (March 30, 1999)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Translator Applicability</TITLE>
<META NAME="description" CONTENT="Translator Applicability">
<META NAME="keywords" CONTENT="clim">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v99.1 release">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="clim.css">

<LINK REL="previous" HREF="node219.html">
<LINK REL="up" HREF="node216.html">
<LINK REL="next" HREF="node221.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html3762"
 HREF="node221.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html3758"
 HREF="node216.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html3754"
 HREF="node219.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html3760"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html3763"
 HREF="node221.html">Standard Presentation Types</A>
<B> Up:</B> <A NAME="tex2html3759"
 HREF="node216.html">Presentation Translators</A>
<B> Previous:</B> <A NAME="tex2html3755"
 HREF="node219.html">Finding Applicable Presentations</A>
 &nbsp <B>  <A NAME="tex2html3761"
 HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION07264000000000000000">
Translator Applicability</A>
</H2>

<P>
The top-level ``input wait'', which is what you are in when inside of a
with-input-context, is responsible for determining what translators are
applicable to which presentations in a given input context.  This loop both
provides feedback in the form of highlighting sensitive presentation, and is
responsible for calling the applicable translator when the user presses a
pointer button.

<P>
 
<B> Implementation note:</B> with-input-context uses
frame-find-innermost-applicable-presentation-at-position (via
highlight-applicable-presentation) as its ``input wait'' handler, and
frame-input-context-button-press-handler as its button press ``event
handler''.

<P>
Given a presentation, an input context established by with-input-context,
and an event corresponding to a user gesture, translator matching proceeds as
follows. 

<P>
The set of candidate translators is initially those translators accessible in
the command table in use by the current application.  A translator is said to
``match'' if all of the following are true (in this order):

<P>

<OL>
<LI>The presentation's type is presentation-subtypep of the translator's
<I> from-type</I>, ignoring type parameters.

<P>
 </LI>
<LI>The translator's <I> to-type</I> is presentation-subtypep of the input
context type, ignoring type parameters.

<P>
 </LI>
<LI>The translator's gesture is either t, or matches the event
corresponding to the user's gesture.

<P>
 </LI>
<LI>If there are parameters in the <I> from-type</I>, the presentation's object
must be presentation-typep of the <I> from-type</I>.

<P>
 </LI>
<LI>The translator's tester returned <I> true</I>.  If there is no tester, the
translator behaves as though there is a tester that always returns <I> true</I>.

<P>
 </LI>
<LI>If there are parameters in the input context type and the tester is not
declared to be definitive, the value returned by body of the translator must be
presentation-typep of the context type.</LI>
</OL>

<P>
Note that the type parameters from the presentation's type have no effect on
translator lookup.

<P>
find-presentation-translator is responsible for the first two steps of the
matching algorithm, and test-presentation-translator is responsible for the
remaining steps.

<P>
When a single translator is being chosen (such as is done by
throw-highlighted-presentation), it is possible that more than one
translator having the same gesture may be applicable to the presentation in the
specified input context.  In this case, the translator having the highest
priority will be chosen.  If there is more than one having the same priority, it
is unspecified what translator will be chosen.

<P>
The matching algorithm is somewhat more complicated in face of nested
presentations and nested input contexts.  In this case, the applicable
presentation is the <I> smallest</I> presentation that matches the <I> innermost</I>
input context.

<P>
Sometimes there may be nested presentations that have exactly the same bounding
rectangle.  In this case, it is not possible for a user to unambiguously point
to just one of the nested presentations.  Therefore, when CLIM has located the
innermost applicable presentation in the innermost input context, it must then
search for outer presentations having exactly the same bounding rectangle,
checking to see if there are any applicable translators for those presentations.
If there are multiple applicable translators, the one having the highest
priority is chosen.  find-applicable-translators,
call-presentation-menu, throw-highlighted-presentation, and the
computation of pointer documentation must all take this situation into account.

<P>
SWM Specify the order of translator search so shadowing can be done
rationally.

<P>
SWM Describe and implement class-nondisjoint-classes idea.  Be
very clear and precise about when the translator body gets run.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html3762"
 HREF="node221.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html3758"
 HREF="node216.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html3754"
 HREF="node219.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html3760"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html3763"
 HREF="node221.html">Standard Presentation Types</A>
<B> Up:</B> <A NAME="tex2html3759"
 HREF="node216.html">Presentation Translators</A>
<B> Previous:</B> <A NAME="tex2html3755"
 HREF="node219.html">Finding Applicable Presentations</A>
 &nbsp <B>  <A NAME="tex2html3761"
 HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>&</I>
<BR><I>2001-06-12</I>
</ADDRESS>
</BODY>
</HTML>
