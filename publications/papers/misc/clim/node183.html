<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.1 release (March 30, 1999)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The Graph Formatting Protocols</TITLE>
<META NAME="description" CONTENT="The Graph Formatting Protocols">
<META NAME="keywords" CONTENT="clim">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v99.1 release">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="clim.css">

<LINK REL="previous" HREF="node182.html">
<LINK REL="up" HREF="node181.html">
<LINK REL="next" HREF="node184.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html3239"
 HREF="node184.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html3235"
 HREF="node181.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html3231"
 HREF="node182.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html3237"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html3240"
 HREF="node184.html">Bordered Output</A>
<B> Up:</B> <A NAME="tex2html3236"
 HREF="node181.html">Graph Formatting</A>
<B> Previous:</B> <A NAME="tex2html3232"
 HREF="node182.html">Graph Formatting Functions</A>
 &nbsp <B>  <A NAME="tex2html3238"
 HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION06420000000000000000">
The Graph Formatting Protocols</A>
</H1>

<P>
Graph formatting is implemented on top of the basic output recording protocol,
using with-new-output-record to specify the appropriate type of output
record.  For example, format-graph-from-roots first collects all the output
that belongs in the graph into a collection of graph node output records by
calling generate-graph-nodes.  All of the graph node output records are
descendents of a single graph output record.  During this phase,
stream-drawing-p is bound to nil and stream-recording-p is bound
to t.  When all the output has been generated, the graph layout code
(layout-graph-nodes and layout-graph-edges) is called to compute the
graph layout.  Finally, the graph output record is positioned on the stream at
the current text cursor position and then displayed by calling replay on
the graph output record.

<P>
graph-output-record

<P>
The protocol class that represents a graph; a subclass of output-record.
a graph output record graph-output-record

<P>
graph-output-record-p object

<P>
Returns <I> true</I> if <I> object</I> is a <I> graph output record</I>, otherwise
returns <I> false</I>.

<P>
standard-graph-output-record

<P>
The instantiable class of output record that represents a graph.  Its children
will be a sequence graph nodes.  This is a subclass of graph-output-record.

<P>
 
:orientation
:center-nodes
:cutoff-depth
:merge-duplicates
:generation-separation
:within-generation-separation
:hash-table

<P>
All the graph output record must handle these seven initargs, which are used to
specify, respectively, the orientation, node centering, cutoff depth, merge
duplicates, generation and within-generation spacing, and the node hash table of
a graph output record.

<P>
 
*graph-type-record-type-alist*

<P>
An alist that map from a graph type to the name of the graph output record class
that implements the graph type.

<P>
graph-root-nodes graph-record

<P>
Returns a sequence of the graph node output records corresponding to the root
objects for the graph output record <I> graph-record</I>.

<P>
 
(setf graph-root-nodes) roots graph-record

<P>
Sets the root nodes of <I> graph-record</I> to <I> roots</I>.

<P>
generate-graph-nodes graph-record stream
                                    root-objects object-printer inferior-producer 
                                    <TT> &amp;key </TT>duplicate-key duplicate-test

<P>
This function is responsible for generating all of the graph node output records
of the graph.  <I> graph-record</I> is the graph output record, and <I> stream</I>
is the output stream.  The graph node output records are generating by calling
the object printer on the root objects, then recursively calling the inferior
producer on the root objects and calling the object printer on all inferiors.
After all of the graph node output records have been generated, the value of
graph-root-nodes of <I> graph-record</I> must be set to be a sequence of the
those graph node output records that correspond to the root objects.

<P>
 
<I> root-objects</I>, <I> object-printer</I>, <I> inferior-producer</I>,
<I> duplicate-key</I>, and <I> duplicate-test</I> are as for
format-graph-from-roots.

<P>
layout-graph-nodes graph-record stream

<P>
This function is responsible for laying out the nodes in the graph.  It is
called after the graph output has been collected, but before the graph record
has been displayed.  The method on standard-graph-output-record implements
the usual graph layout constraint solver.

<P>
layout-graph-edges graph-record stream arc-drawer arc-drawing-options

<P>
This function is responsible for laying out the edges in the graph.  It is
called after the graph nodes have been layed out, but before the graph record
has been displayed.  The method on standard-graph-output-record simply
causes thin lines to be drawn from each node to all of its children.

<P>
graph-node-output-record

<P>
The protocol class that represents a node in graph; a subclass of
output-record.
a graph node output record graph-node-output-record

<P>
graph-node-output-record-p object

<P>
Returns <I> true</I> if <I> object</I> is a <I> graph node output record</I>,
otherwise returns <I> false</I>.

<P>
standard-graph-node-output-record

<P>
The instantiable class of output record that represents a graph node.  Its
parent will be a graph output record.  This is a subclass of
graph-node-output-record.

<P>
graph-node-parents graph-node-record

<P>
Returns a sequence of the graph node output records whose objects are
``parents'' of the object corresponding to the graph node output record
<I> graph-node-record</I>.  Note that this is not the same as
output-record-parent, since graph-node-parents can return output
records that are not the parent records of <I> graph-node-record</I>.

<P>
 
(setf graph-node-parents) parents graph-node-record

<P>
Sets the parents of <I> graph-node-record</I> to be <I> parents</I>.  <I> parents</I>
must be a list of graph node records.

<P>
graph-node-children graph-node-record

<P>
Returns a sequence of the graph node output records whose objects are
``children'' of the object corresponding to the graph node output record
<I> graph-node-record</I>.  Note that this is not the same as
output-record-children, since graph-node-children can return output
records that are not child records of <I> graph-node-record</I>.

<P>
 
(setf graph-node-children) children graph-node-record

<P>
Sets the children of <I> graph-node-record</I> to be <I> children</I>.
<I> children</I> must be a list of graph node records.

<P>
graph-node-object graph-node-record

<P>
Returns the object that corresponds to the graph node output record
<I> graph-node-record</I>.  It is permissible for this function to work correctly
only while inside of the call to format-graph-from-roots.  It is unspecified
what result will be returned outside of format-graph-from-roots.  This
restriction is permitted so that CLIM is not required to capture application
objects that might have dynamic extent.

<HR>
<!--Navigation Panel-->
<A NAME="tex2html3239"
 HREF="node184.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/icons/next_motif.gif"></A> 
<A NAME="tex2html3235"
 HREF="node181.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/icons/up_motif.gif"></A> 
<A NAME="tex2html3231"
 HREF="node182.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/icons/previous_motif.gif"></A> 
<A NAME="tex2html3237"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/icons/contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html3240"
 HREF="node184.html">Bordered Output</A>
<B> Up:</B> <A NAME="tex2html3236"
 HREF="node181.html">Graph Formatting</A>
<B> Previous:</B> <A NAME="tex2html3232"
 HREF="node182.html">Graph Formatting Functions</A>
 &nbsp <B>  <A NAME="tex2html3238"
 HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>&</I>
<BR><I>2001-06-12</I>
</ADDRESS>
</BODY>
</HTML>
